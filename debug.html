<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>ä»˜è´¹åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial;
            padding: 20px;
        }

        .success {
            color: green;
        }

        .error {
            color: red;
        }

        .info {
            color: blue;
        }

        button {
            padding: 10px 20px;
            margin: 5px;
        }
    </style>
</head>

<body>
    <h1>ä»˜è´¹åŠŸèƒ½è°ƒè¯•å·¥å…·</h1>

    <div id="status"></div>

    <h2>å½“å‰çŠ¶æ€</h2>
    <div id="current-state"></div>

    <h2>æ“ä½œ</h2>
    <button onclick="clearCache()">æ¸…é™¤localStorage</button>
    <button onclick="checkLocks()">æ£€æŸ¥é”å®šçŠ¶æ€</button>
    <button onclick="testPayment()">æµ‹è¯•æ”¯ä»˜å¼¹çª—</button>
    <button onclick="window.location.href='index.html'">è¿”å›ä¸»é¡µ</button>

    <h2>è¯¾ç¨‹åˆ—è¡¨</h2>
    <div id="lessons"></div>

    <script>
        window.onload = function () {
            updateStatus();
        };

        function updateStatus() {
            const isPaid = localStorage.getItem('isPaid') === 'true';
            const statusDiv = document.getElementById('status');
            const stateDiv = document.getElementById('current-state');

            statusDiv.innerHTML = isPaid
                ? '<p class="success">âœ… å½“å‰çŠ¶æ€ï¼šå·²ä»˜è´¹</p>'
                : '<p class="error">âŒ å½“å‰çŠ¶æ€ï¼šæœªä»˜è´¹</p>';

            // Load from external file
            const script = document.createElement('script');
            script.src = 'content.js';
            script.onload = function () {
                if (typeof window.courseData !== 'undefined') {
                    const lessons = Object.keys(window.courseData);
                    stateDiv.innerHTML = `
                        <p class="info">ğŸ“š æ£€æµ‹åˆ° ${lessons.length} ç¯‡è¯¾ç¨‹</p>
                        <p class="info">ğŸ”“ å‰3ç¯‡å…è´¹ï¼š${lessons.slice(0, 3).join(', ')}</p>
                        <p class="info">ğŸ”’ éœ€è¦ä»˜è´¹ï¼šä»ç¬¬${4}ç¯‡å¼€å§‹</p>
                    `;

                    // Display lesson list
                    const lessonsDiv = document.getElementById('lessons');
                    lessonsDiv.innerHTML = lessons.slice(0, 10).map((title, index) => {
                        const isFree = index < 3;
                        const status = isFree ? 'ğŸ”“ å…è´¹' : 'ğŸ”’ ä»˜è´¹';
                        const className = isFree ? 'success' : 'error';
                        return `<p class="${className}">${index + 1}. ${title} - ${status}</p>`;
                    }).join('');
                } else {
                    stateDiv.innerHTML = '<p class="error">âŒ é”™è¯¯ï¼šcourseDataæœªåŠ è½½ï¼</p>';
                }
            };
            document.head.appendChild(script);
        }

        function clearCache() {
            localStorage.clear();
            alert('localStorageå·²æ¸…é™¤ï¼é¡µé¢å°†åˆ·æ–°ã€‚');
            window.location.reload();
        }

        function checkLocks() {
            alert('è¯·æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·(F12)ï¼Œåˆ‡æ¢åˆ°Consoleæ ‡ç­¾ï¼Œç„¶åè¿”å›ä¸»é¡µæŸ¥çœ‹é”å®šå›¾æ ‡ã€‚');
            console.log('=== é”å®šåŠŸèƒ½æ£€æŸ¥ ===');
            console.log('å…è´¹è¯¾ç¨‹ï¼šå‰3ç¯‡');
            console.log('ä»˜è´¹è¯¾ç¨‹ï¼šç¬¬4ç¯‡åŠä¹‹å');
            console.log('å½“å‰ä»˜è´¹çŠ¶æ€ï¼š', localStorage.getItem('isPaid'));
        }

        function testPayment() {
            localStorage.setItem('isPaid', 'true');
            alert('å·²æ¨¡æ‹Ÿä»˜è´¹æˆåŠŸï¼è¿”å›ä¸»é¡µæŸ¥çœ‹æ‰€æœ‰è¯¾ç¨‹å·²è§£é”ã€‚');
        }
    </script>
</body>

</html>